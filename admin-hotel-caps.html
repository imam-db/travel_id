<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Caps Configuration - TrevID</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <img 
                    class="brand-logo" 
                    src="assets/brand/trevid_logo.png" 
                    srcset="/assets/brand/trevid_logo.png 1x, /assets/brand/trevid_logo@2x.png 2x" 
                    alt="TrevID â€“ Business Companion" 
                    width="140" height="36" />
            </div>
            <div class="user-info">
                <span>Hello, Admin User</span>
                <i class="fas fa-user-circle"></i>
            </div>
        </div>
    </header>

    <div class="container-fluid mt-4">
        <!-- Breadcrumb -->
        <nav aria-label="breadcrumb" class="admin-breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="admin.html">Admin</a></li>
                <li class="breadcrumb-item"><a href="admin.html">Policies</a></li>
                <li class="breadcrumb-item active" aria-current="page">Hotel Caps</li>
            </ol>
        </nav>

        <!-- Page Header -->
        <div class="admin-page-header">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1><i class="fas fa-bed"></i>Hotel Caps Configuration</h1>
                    <p>Manage hotel accommodation spending limits by location and class</p>
                </div>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#hotelCapModal">
                    <i class="fas fa-plus me-2"></i>Add Hotel Cap
                </button>
            </div>
        </div>

        <!-- Filter Section -->
        <div class="card admin-filter-card">
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-md-3">
                        <label class="form-label">Location</label>
                        <select class="form-select" id="filterLocation">
                            <option value="">All Locations</option>
                            <option value="jakarta">Jakarta</option>
                            <option value="surabaya">Surabaya</option>
                            <option value="bandung">Bandung</option>
                            <option value="bali">Bali</option>
                            <option value="singapore">Singapore</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">Hotel Class</label>
                        <select class="form-select" id="filterClass">
                            <option value="">All Classes</option>
                            <option value="budget">Budget (1-2 Star)</option>
                            <option value="standard">Standard (3 Star)</option>
                            <option value="superior">Superior (4 Star)</option>
                            <option value="luxury">Luxury (5 Star)</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">Status</label>
                        <select class="form-select" id="filterStatus">
                            <option value="">All Status</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">Search</label>
                        <input type="text" class="form-control" id="searchInput" placeholder="Search location or class...">
                    </div>
                </div>
            </div>
        </div>

        <!-- Hotel Caps Table -->
        <div class="card admin-table-card">
            <div class="card-header">
                <h5 class="card-title mb-0">Hotel Caps</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover" id="hotelCapsTable">
                        <thead>
                            <tr>
                                <th>Location</th>
                                <th>Hotel Class</th>
                                <th>Max Rate (IDR/night)</th>
                                <th>Currency</th>
                                <th>Effective Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="hotelCapsTableBody">
                            <!-- Data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Hotel Cap Modal -->
    <div class="modal fade" id="hotelCapModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="hotelCapModalTitle">Add Hotel Cap</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="hotelCapForm">
                        <input type="hidden" id="hotelCapId">
                        <div class="mb-3">
                            <label class="form-label">Location *</label>
                            <select class="form-select" id="hotelCapLocation" required>
                                <option value="">Select Location</option>
                                <option value="jakarta">Jakarta</option>
                                <option value="surabaya">Surabaya</option>
                                <option value="bandung">Bandung</option>
                                <option value="bali">Bali</option>
                                <option value="singapore">Singapore</option>
                                <option value="kuala-lumpur">Kuala Lumpur</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Hotel Class *</label>
                            <select class="form-select" id="hotelCapClass" required>
                                <option value="">Select Class</option>
                                <option value="budget">Budget (1-2 Star)</option>
                                <option value="standard">Standard (3 Star)</option>
                                <option value="superior">Superior (4 Star)</option>
                                <option value="luxury">Luxury (5 Star)</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Maximum Rate *</label>
                            <input type="number" class="form-control" id="hotelCapRate" required min="0" step="1000">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Currency *</label>
                            <select class="form-select" id="hotelCapCurrency" required>
                                <option value="IDR">IDR - Indonesian Rupiah</option>
                                <option value="USD">USD - US Dollar</option>
                                <option value="SGD">SGD - Singapore Dollar</option>
                                <option value="MYR">MYR - Malaysian Ringgit</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Effective Date *</label>
                            <input type="date" class="form-control" id="hotelCapEffectiveDate" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Status</label>
                            <select class="form-select" id="hotelCapStatus">
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Notes</label>
                            <textarea class="form-control" id="hotelCapNotes" rows="3" placeholder="Additional notes or conditions..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveHotelCap()">Save Hotel Cap</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Sample hotel caps data
        let hotelCaps = [
            {
                id: 1,
                location: 'jakarta',
                locationName: 'Jakarta',
                class: 'budget',
                className: 'Budget (1-2 Star)',
                rate: 500000,
                currency: 'IDR',
                effectiveDate: '2024-01-01',
                status: 'active',
                notes: 'Standard budget accommodation'
            },
            {
                id: 2,
                location: 'jakarta',
                locationName: 'Jakarta',
                class: 'standard',
                className: 'Standard (3 Star)',
                rate: 800000,
                currency: 'IDR',
                effectiveDate: '2024-01-01',
                status: 'active',
                notes: 'Business standard hotels'
            },
            {
                id: 3,
                location: 'singapore',
                locationName: 'Singapore',
                class: 'superior',
                className: 'Superior (4 Star)',
                rate: 200,
                currency: 'SGD',
                effectiveDate: '2024-01-01',
                status: 'active',
                notes: 'International business travel'
            }
        ];

        function renderHotelCapsTable() {
            const tbody = document.getElementById('hotelCapsTableBody');
            const filteredCaps = getFilteredHotelCaps();
            
            tbody.innerHTML = filteredCaps.map(cap => `
                <tr>
                    <td>${cap.locationName}</td>
                    <td>${cap.className}</td>
                    <td>${formatCurrency(cap.rate, cap.currency)}</td>
                    <td>${cap.currency}</td>
                    <td>${formatDate(cap.effectiveDate)}</td>
                    <td>
                        <span class="badge bg-${cap.status === 'active' ? 'success' : 'secondary'}">
                            ${cap.status.charAt(0).toUpperCase() + cap.status.slice(1)}
                        </span>
                    </td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary me-1" onclick="editHotelCap(${cap.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteHotelCap(${cap.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function getFilteredHotelCaps() {
            const locationFilter = document.getElementById('filterLocation').value;
            const classFilter = document.getElementById('filterClass').value;
            const statusFilter = document.getElementById('filterStatus').value;
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();

            return hotelCaps.filter(cap => {
                const matchesLocation = !locationFilter || cap.location === locationFilter;
                const matchesClass = !classFilter || cap.class === classFilter;
                const matchesStatus = !statusFilter || cap.status === statusFilter;
                const matchesSearch = !searchTerm || 
                    cap.locationName.toLowerCase().includes(searchTerm) ||
                    cap.className.toLowerCase().includes(searchTerm);
                
                return matchesLocation && matchesClass && matchesStatus && matchesSearch;
            });
        }

        function formatCurrency(amount, currency) {
            return new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: currency,
                minimumFractionDigits: 0
            }).format(amount);
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('id-ID');
        }

        function editHotelCap(id) {
            const cap = hotelCaps.find(c => c.id === id);
            if (cap) {
                document.getElementById('hotelCapId').value = cap.id;
                document.getElementById('hotelCapLocation').value = cap.location;
                document.getElementById('hotelCapClass').value = cap.class;
                document.getElementById('hotelCapRate').value = cap.rate;
                document.getElementById('hotelCapCurrency').value = cap.currency;
                document.getElementById('hotelCapEffectiveDate').value = cap.effectiveDate;
                document.getElementById('hotelCapStatus').value = cap.status;
                document.getElementById('hotelCapNotes').value = cap.notes || '';
                
                document.getElementById('hotelCapModalTitle').textContent = 'Edit Hotel Cap';
                new bootstrap.Modal(document.getElementById('hotelCapModal')).show();
            }
        }

        function deleteHotelCap(id) {
            if (confirm('Are you sure you want to delete this hotel cap?')) {
                hotelCaps = hotelCaps.filter(c => c.id !== id);
                renderHotelCapsTable();
            }
        }

        function saveHotelCap() {
            const form = document.getElementById('hotelCapForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const id = document.getElementById('hotelCapId').value;
            const location = document.getElementById('hotelCapLocation').value;
            const locationName = document.getElementById('hotelCapLocation').selectedOptions[0].text;
            const capClass = document.getElementById('hotelCapClass').value;
            const className = document.getElementById('hotelCapClass').selectedOptions[0].text;
            const rate = parseInt(document.getElementById('hotelCapRate').value);
            const currency = document.getElementById('hotelCapCurrency').value;
            const effectiveDate = document.getElementById('hotelCapEffectiveDate').value;
            const status = document.getElementById('hotelCapStatus').value;
            const notes = document.getElementById('hotelCapNotes').value;

            if (id) {
                // Edit existing
                const index = hotelCaps.findIndex(c => c.id === parseInt(id));
                if (index !== -1) {
                    hotelCaps[index] = {
                        ...hotelCaps[index],
                        location, locationName, class: capClass, className,
                        rate, currency, effectiveDate, status, notes
                    };
                }
            } else {
                // Add new
                const newId = Math.max(...hotelCaps.map(c => c.id)) + 1;
                hotelCaps.push({
                    id: newId,
                    location, locationName, class: capClass, className,
                    rate, currency, effectiveDate, status, notes
                });
            }

            bootstrap.Modal.getInstance(document.getElementById('hotelCapModal')).hide();
            form.reset();
            document.getElementById('hotelCapId').value = '';
            document.getElementById('hotelCapModalTitle').textContent = 'Add Hotel Cap';
            renderHotelCapsTable();
        }

        // Event listeners
        document.getElementById('filterLocation').addEventListener('change', renderHotelCapsTable);
        document.getElementById('filterClass').addEventListener('change', renderHotelCapsTable);
        document.getElementById('filterStatus').addEventListener('change', renderHotelCapsTable);
        document.getElementById('searchInput').addEventListener('input', renderHotelCapsTable);

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            renderHotelCapsTable();
            
            // Set default effective date to today
            document.getElementById('hotelCapEffectiveDate').value = new Date().toISOString().split('T')[0];
        });
    </script>
</body>
</html>
